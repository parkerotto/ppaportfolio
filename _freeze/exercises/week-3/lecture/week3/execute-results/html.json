{
  "hash": "9fa96bfddfa27409e351d6fcf0a2f464",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Data Visualization & Exploratory Analysis\"\nsubtitle: \"Week 3: CPLN 5920/MUSA 5080\"\nauthor: \"Dr. Allison Lassiter\"\ndate: \"February 3, 2026\"\nformat: \n  revealjs:\n    theme: simple\n    slide-number: true\n    chalkboard: true\n    code-line-numbers: true\n    incremental: false\n    smaller: true\n---\n\n# Today's Agenda\n\n## What We'll Cover\n\n**Part 1: Why Visualization Matters** \n\n- Anscombe's Quartet and the limits of summary statistics\n- Visualization in policy context\n- Connection to algorithmic bias and data ethics\n\n**Part 2: Grammar of Graphics** \n\n- ggplot2 fundamentals\n- Aesthetic mappings and geoms\n- Live demonstration\n\n**Part 3: Exploratory Data Analysis** \n\n- EDA workflow and principles\n- Understanding distributions and relationships\n- **Critical focus: Data quality and uncertainty**\n\n**Part 4: Data Joins & Integration** \n\n- Combining datasets with dplyr joins\n\n**Part 5: Hands-On Lab** \n\n- Guided practice with census data\n- Create publication-ready visualizations\n- **Practice ethical data communication**\n\n---\n\n# Part 1: Why Visualization Matters\n\n## Opening Question\n\n**Think about Lab 1:**\n\nYou created a table showing income reliability patterns across counties. But what if you needed to present these findings to:\n\n- The state legislature (2-minute briefing)\n- Community advocacy groups\n- Local news reporters\n\n**Discussion:** How might visual presentation change the impact of your analysis?\n\n## Anscombe's Quartet: The Famous Example\n\n**Four datasets with identical summary statistics:**\n\n- Same means (x̄ = 9, ȳ = 7.5)\n- Same variances \n- Same correlation (r = 0.816)\n- Same regression line\n\n**But completely different patterns when visualized**\n\n## The Policy Implications\n\n**Why this matters for your work:**\n\n- **Summary statistics can hide critical patterns**\n- **Outliers may represent important communities**\n- **Relationships aren't always linear**\n- **Visual inspection reveals data quality issues**\n\n**Example:** A county with \"average\" income might have extreme inequality that algorithms would miss without visualization.\n\n## Connecting Week 2: Ethical Data Communication\n\n**From last week's algorithmic bias discussion:**\n\n**Research finding:** Only **27% of planners** warn users about unreliable ACS data\n- Most planners don't report margins of error\n- Many lack training on statistical uncertainty\n- **This violates AICP Code of Ethics**\n\n**Your responsibility:**\n\n- Create honest, transparent visualizations\n- Always assess and communicate data quality\n- Consider who might be harmed by uncertain data\n\n## Bad Visualizations Have Real Consequences\n\n**Common problems in government data presentation:**\n\n- Misleading scales or axes\n- Cherry-picked time periods  \n- **Hidden or ignored uncertainty**\n- Missing context about data reliability\n\n**Real impact:** \nThe Jurjevich et al. study found that **72% of Portland census tracts** had unreliable child poverty estimates, yet planners rarely communicated this uncertainty.\n\n**Result:** Poor policy decisions based on misunderstood data\n\n---\n\n# Part 2: Grammar of Graphics\n\n## The ggplot2 Philosophy\n\n**Grammar of Graphics principles:**\n\n**Data** → **Aesthetics** → **Geometries** → **Visual**\n\n- **Data:** Your dataset (census data, survey responses, etc.)\n- **Aesthetics:** What variables map to visual properties (x, y, color, size)\n- **Geometries:** How to display the data (points, bars, lines)\n- **Additional layers:** Scales, themes, facets, annotations\n\n## Basic ggplot2 Structure\n\n**Every ggplot has this pattern:**\n\n`ggplot(data = your_data) +\n  aes(x = variable1, y = variable2) +\n  geom_something() +\n  additional_layers()`\n\n\n***You build plots by adding layers with `+`***\n\n## Live Demo: Basic Scatter Plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'ggplot2' was built under R version 4.3.3\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(tidycensus)\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ lubridate 1.9.2     ✔ tibble    3.2.1\n✔ purrr     1.0.1     ✔ tidyr     1.3.0\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\n# Set your Census API key if you haven't already\ncensus_api_key(Sys.getenv(\"CENSUS_API_KEY\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nTo install your API key for use in future sessions, run this function with `install = TRUE`.\n```\n\n\n:::\n\n```{.r .cell-code}\n# Get some census data for demonstration\ndemo_data <- get_acs(\n  geography = \"county\",\n  variables = c(\n    median_income = \"B19013_001\",\n    total_pop = \"B01003_001\"\n  ),\n  state = \"PA\",\n  year = 2022,\n  output = \"wide\"\n) %>%\n  mutate(county_name = str_remove(NAME, \", Pennsylvania\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nGetting data from the 2018-2022 5-year ACS\n```\n\n\n:::\n\n```{.r .cell-code}\n# Basic scatter plot\nggplot(demo_data) +\n  aes(x = total_popE, y = median_incomeE) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](week3_files/figure-html/demo-scatter-1.png){width=672}\n:::\n:::\n\n\n## Aesthetic Mappings: The Key to ggplot2\n\n**Aesthetics map data to visual properties:**\n\n- `x`, `y` - position\n- `color` - point/line color\n- `fill` - area fill color  \n- `size` - point/line size\n- `shape` - point shape\n- `alpha` - transparency\n\n**Important:** Aesthetics go inside `aes()`, constants go outside\n\n## Improving Plots with Labels and Themes\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(demo_data) +\n  aes(x = total_popE, y = median_incomeE) +\n  geom_point(alpha = 0.7) +\n  geom_smooth(method = \"lm\", se = TRUE) +\n  labs(\n    title = \"Income vs Population in Pennsylvania Counties\",\n    subtitle = \"2018-2022 ACS 5-Year Estimates\",\n    x = \"Total Population\",\n    y = \"Median Household Income ($)\",\n    caption = \"Source: U.S. Census Bureau ACS\"\n  ) +\n  theme_minimal() +\n  scale_y_continuous(labels = scales::dollar) +\n  scale_x_continuous(labels = scales::comma)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](week3_files/figure-html/better-plot-1.png){width=672}\n:::\n:::\n\n\n---\n\n# Part 3: Exploratory Data Analysis\n\n## The EDA Mindset\n\n**Exploratory Data Analysis is detective work:**\n\n1. **What does the data look like?** (distributions, missing values)\n2. **What patterns exist?** (relationships, clusters, trends)  \n3. **What's unusual?** (outliers, anomalies, data quality issues)\n4. **What questions does this raise?** (hypotheses for further investigation)\n5. **How reliable is this data?** \n\n**Goal:** Understand your data before making decisions or building models\n\n## EDA Workflow with Data Quality Focus\n\n**Enhanced process for policy analysis:**\n\n1. **Load and inspect** - dimensions, variable types, missing data\n2. **Assess reliability** - examine margins of error, calculate coefficients of variation\n3. **Visualize distributions** - histograms, boxplots for each variable\n4. **Explore relationships** - scatter plots, correlations\n5. **Identify patterns** - grouping, clustering, geographical patterns\n6. **Question anomalies** - investigate outliers and unusual patterns\n7. **Document limitations** - prepare honest communication about data quality\n\n## Understanding Distributions\n\n**Why distribution shape matters:**\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Histogram of median income\nggplot(demo_data) +\n  aes(x = median_incomeE) +\n  geom_histogram(bins = 15, fill = \"steelblue\", alpha = 0.7) +\n  labs(title = \"Distribution of Median Income\",\n       x = \"Median Household Income\", \n       y = \"Number of Counties\")\n```\n\n::: {.cell-output-display}\n![](week3_files/figure-html/distribution-demo-1.png){width=672}\n:::\n:::\n\n\n**What to look for:** Skewness, outliers, multiple peaks, gaps\n\n## Boxplots!\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Boxplot to see outliers and quartiles  \nggplot(demo_data) +\n  aes(y = median_incomeE) +\n  geom_boxplot(fill = \"lightblue\") +\n  labs(title = \"Income Distribution with Outliers\",\n       y = \"Median Household Income\")\n```\n\n::: {.cell-output-display}\n![](week3_files/figure-html/boxplot-1.png){width=672}\n:::\n:::\n\n\n## Critical: Data Quality Through Visualization\n\n**Research insight:** Most planners don't visualize or communicate uncertainty\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Visualize margins of error - ESSENTIAL for ethical practice\ndemo_data %>%\n  mutate(moe_pct = median_incomeM / median_incomeE * 100) %>%\n  ggplot() +\n  aes(x = total_popE, y = moe_pct) +\n  geom_point() +\n  geom_hline(yintercept = 10, color = \"red\", linetype = \"dashed\") +\n  labs(title = \"Data Reliability by Population Size\",\n       x = \"Population\", \n       y = \"Margin of Error (%)\",\n       caption = \"Red line = 10% threshold for reliability\")\n```\n\n::: {.cell-output-display}\n![](week3_files/figure-html/quality-viz-1.png){width=672}\n:::\n:::\n\n\n**Pattern:** Smaller populations have higher uncertainty\n**Ethical implication:** These communities might be systematically undercounted\n\n## Research-Based Recommendations for Planners\n\n**Jurjevich et al. (2018): 5 Essential Guidelines for Using ACS Data**\n\n1. **Report the corresponding MOEs of ACS estimates** - Always include margin of error values\n2. **Include a footnote when not reporting MOEs** - Explicitly acknowledge omission  \n3. **Provide context for (un)reliability** - Use coefficient of variation (CV):\n   - CV < 12% = reliable (green coding)\n   - CV 12-40% = somewhat reliable (yellow)\n   - CV > 40% = unreliable (red coding)\n4. **Reduce statistical uncertainty** - Collapse data detail, aggregate geographies, use multi-year estimates\n5. **Always conduct statistical significance tests** when comparing ACS estimates over time\n\n**Key insight:** These practices are not just technical best practices—they are **ethical requirements** under the AICP Code of Ethics\n\n## EDA for Policy Analysis\n\n**Key questions for census data:**\n\n- **Geographic patterns:** Are problems concentrated in certain areas?\n- **Population relationships:** How does size affect data quality?\n- **Demographic patterns:** Are certain communities systematically different?\n- **Temporal trends:** How do patterns change over time?\n- **Data integrity:** Where might survey bias affect results?\n- **Reliability assessment:** Which estimates should we trust?\n\n---\n\n# Part 4: Data Joins & Integration\n\n## Why Join Data?\n\n**To combining datasets of course:**\n\n- Census demographics + Economic indicators\n- Survey responses + Geographic boundaries  \n- Current data + Historical trends\n- Administrative records + Survey data\n\n## Types of Joins (tabular)\n\n**Four main types in dplyr:**\n\n- `left_join()` - Keep all rows from left dataset\n- `right_join()` - Keep all rows from right dataset  \n- `inner_join()` - Keep only rows that match in both\n- `full_join()` - Keep all rows from both datasets\n\n**Most common:** `left_join()` to add columns to your main dataset\n\n## Live Demo: Joining Census Tables\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get income data\nincome_data <- get_acs(\n  geography = \"county\",\n  variables = \"B19013_001\",\n  state = \"PA\", \n  year = 2022,\n  output = \"wide\"\n) %>%\n  select(GEOID, NAME, median_income = B19013_001E, income_moe = B19013_001M)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nGetting data from the 2018-2022 5-year ACS\n```\n\n\n:::\n\n```{.r .cell-code}\n# Get education data  \neducation_data <- get_acs(\n  geography = \"county\",\n  variables = \"B15003_022\",  # Bachelor's degree or higher\n  state = \"PA\",\n  year = 2022, \n  output = \"wide\"\n) %>%\n  select(GEOID, college_pop = B15003_022E, college_moe = B15003_022M)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nGetting data from the 2018-2022 5-year ACS\n```\n\n\n:::\n\n```{.r .cell-code}\n# Join them together\ncombined_data <- income_data %>%\n  left_join(education_data, by = \"GEOID\")\n\nhead(combined_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 6\n  GEOID NAME                    median_income income_moe college_pop college_moe\n  <chr> <chr>                           <dbl>      <dbl>       <dbl>       <dbl>\n1 42001 Adams County, Pennsylv…         78975       3334       10195         761\n2 42003 Allegheny County, Penn…         72537        869      229538        3311\n3 42005 Armstrong County, Penn…         61011       2202        6171         438\n4 42007 Beaver County, Pennsyl…         67194       1531       22588        1012\n5 42009 Bedford County, Pennsy…         58337       2606        3396         307\n6 42011 Berks County, Pennsylv…         74617       1191       50120        1654\n```\n\n\n:::\n:::\n\n\n## Checking Join Results and Data Quality\n\n**Always verify joins AND assess combined reliability:**\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Check dimensions\ncat(\"Income data rows:\", nrow(income_data), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nIncome data rows: 67 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Education data rows:\", nrow(education_data), \"\\n\") \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nEducation data rows: 67 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Combined data rows:\", nrow(combined_data), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCombined data rows: 67 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Check for missing values after join\ncombined_data %>%\n  summarize(\n    missing_income = sum(is.na(median_income)),\n    missing_education = sum(is.na(college_pop))\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 2\n  missing_income missing_education\n           <int>             <int>\n1              0                 0\n```\n\n\n:::\n\n```{.r .cell-code}\n# IMPORTANT: Assess reliability of joined data\ncombined_data %>%\n  mutate(\n    income_cv = (income_moe / median_income) * 100,\n    college_cv = (college_moe / college_pop) * 100\n  ) %>%\n  select(NAME, income_cv, college_cv) %>%\n  head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 3\n  NAME                           income_cv college_cv\n  <chr>                              <dbl>      <dbl>\n1 Adams County, Pennsylvania          4.22       7.46\n2 Allegheny County, Pennsylvania      1.20       1.44\n3 Armstrong County, Pennsylvania      3.61       7.10\n4 Beaver County, Pennsylvania         2.28       4.48\n5 Bedford County, Pennsylvania        4.47       9.04\n6 Berks County, Pennsylvania          1.60       3.30\n```\n\n\n:::\n:::\n\n\n---\n\n# Part 5: Hands-On Lab Introduction\n\n## Lab Structure for Today\n\n**You'll work through six exercises:**\n\n1. **Finding Census Variables** - Learn to search for the data you need\n2. **Single Variable EDA** - Explore distributions and identify outliers\n3. **Two Variable Relationships** - Create meaningful scatter plots\n4. **Data Quality Visualization** - **Practice ethical uncertainty communication**\n5. **Multiple Variables** - Color, faceting, and complex relationships\n6. **Data Integration** - Join datasets and create publication-ready visualizations\n\n## Skills You'll Practice\n\n**ggplot2 fundamentals:**\n\n- Scatter plots, histograms, boxplots\n- Aesthetic mappings and customization\n- Professional themes and labels\n\n**EDA workflow:**\n\n- Distribution analysis\n- Outlier detection  \n- Pattern identification\n\n**Ethical data practice:**\n\n- Visualizing and reporting margins of error\n- Using coefficient of variation to assess reliability\n\n## Connection to Professional Ethics\n\n**By the end of today, you'll be able to:**\n\n- Visually assess data quality issues\n- Create compelling presentations of demographic patterns\n- Communicate statistical uncertainty ethically and clearly\n- Integrate multiple data sources \n\n---\n\n# Getting Started\n\n## Questions Before We Begin?\n\n**Ready for hands-on practice?**\n\n**Remember:** Today's skills build directly on Week 1-2 foundations:\n\n- Same dplyr functions, now with visualization\n- Same census data concepts, now with multiple tables\n\n*Let's create some beautiful graphs*",
    "supporting": [
      "week3_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}